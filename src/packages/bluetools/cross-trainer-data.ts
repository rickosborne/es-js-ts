import { type DataViewReader, dataViewReader } from "./data-view-reader.js";

// This file is autogenerated.
// Do not edit it by hand, as changes will be lost.
// Upstream source: https://raw.githubusercontent.com/oesmith/gatt-xml/refs/heads/master/org.bluetooth.characteristic.cross_trainer_data.xml
/** <p>The Cross Trainer Data characteristic is used to send training-related data to the Client from a cross trainer (Server).</p> */
export interface CrossTrainerData {
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.power.watt`</p>
     * <p>Watts with a resolution of 1</p>
     */
    averagePower?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.velocity.kilometre_per_hour`</p>
     * <p>Kilometer per hour with a resolution of 0.01</p>
     */
    averageSpeed?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.step_per_minute`</p>
     * <p>Step/minute with a resolution of 1</p>
     */
    averageStepRate?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.time.second`</p>
     * <p>Second with a resolution of 1</p>
     */
    elapsedTime?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.energy.kilogram_calorie`</p>
     * <p>Kilo Calorie with a resolution of 1</p>
     */
    energyPerHour?: number | undefined;
    /**
     * <p>Format: `uint8`</p>
     * <p>Unit: `org.bluetooth.unit.energy.kilogram_calorie`</p>
     * <p>Kilo Calorie with a resolution of 1</p>
     */
    energyPerMinute?: number | undefined;
    /**
     * <p>Format: `24bit`</p>
     *
     * Bit field:
     *
     * | index | size | req | name                                       |
     * | ----- | ---- | --- | ------------------------------------------ |
     * | 0     | 1    | C1  | More Data                                  |
     * | 1     | 1    | C2  | Average Speed present                      |
     * | 2     | 1    | C3  | Total Distance Present                     |
     * | 3     | 1    | C4  | Step Count present                         |
     * | 4     | 1    | C5  | Stride Count present                       |
     * | 5     | 1    | C6  | Elevation Gain present                     |
     * | 6     | 1    | C7  | Inclination and Ramp Angle Setting present |
     * | 7     | 1    | C8  | Resistance Level Present                   |
     * | 8     | 1    | C9  | Instantaneous Power present                |
     * | 9     | 1    | C10 | Average Power present                      |
     * | 10    | 1    | C11 | Expended Energy present                    |
     * | 11    | 1    | C12 | Heart Rate present                         |
     * | 12    | 1    | C13 | Metabolic Equivalent present               |
     * | 13    | 1    | C14 | Elapsed Time present                       |
     * | 14    | 1    | C15 | Remaining Time present                     |
     * | 15    | 1    |     | Movement Direction                         |
     * | 16    | 8    |     | Reserved for future use                    |
     *
     */
    flags: number;
    /**
     * <p>Format: `uint8`</p>
     * <p>Unit: `org.bluetooth.unit.period.beats_per_minute`</p>
     * <p>Beats per minute with a resolution of 1</p>
     */
    heartRate?: number | undefined;
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.percentage`</p>
     * <p>Percent with a resolution of 0.1</p>
     */
    inclination?: number | undefined;
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.power.watt`</p>
     * <p>Watts with a resolution of 1</p>
     */
    instantaneousPower?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.velocity.kilometre_per_hour`</p>
     * <p>Kilometer per hour with a resolution of 0.01</p>
     */
    instantaneousSpeed?: number | undefined;
    /**
     * <p>Format: `uint8`</p>
     * <p>Unit: `org.bluetooth.unit.metabolic_equivalent`</p>
     * <p>Metabolic Equivalent with a resolution of 0.1</p>
     */
    metabolicEquivalent?: number | undefined;
    /**
     * | value | description |
     * | ----- | ----------- |
     * | 0     | Forward     |
     * | 1     | Backward    |
     */
    movementDirection: number;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.length.metre`</p>
     * <p>Meters with a resolution of 1</p>
     */
    negativeElevationGain?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.length.metre`</p>
     * <p>Meters with a resolution of 1</p>
     */
    positiveElevationGain?: number | undefined;
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.plane_angle.degree`</p>
     * <p>Degree with a resolution of 0.1</p>
     */
    rampAngleSetting?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.time.second`</p>
     * <p>Second with a resolution of 1</p>
     */
    remainingTime?: number | undefined;
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.unitless`</p>
     * <p>Unitless with a resolution of 0.1</p>
     */
    resistanceLevel?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.step_per_minute`</p>
     * <p>Step/minute with a resolution of 1</p>
     */
    stepPerMinute?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.unitless`</p>
     * <p>Unitless with a resolution of 0.1</p>
     */
    strideCount?: number | undefined;
    /**
     * <p>Format: `uint24`</p>
     * <p>Unit: `org.bluetooth.unit.length.metre`</p>
     * <p>Meters with a resolution of 1</p>
     */
    totalDistance?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.energy.kilogram_calorie`</p>
     * <p>Kilo Calorie with a resolution of 1</p>
     */
    totalEnergy?: number | undefined;
}

/** @see {@link https://raw.githubusercontent.com/oesmith/gatt-xml/refs/heads/master/org.bluetooth.characteristic.cross_trainer_data.xml | Cross Trainer Data} */
export class CrossTrainerDataImpl implements CrossTrainerData {
    public static readonly UUID_PREFIX = 0x2ace;
    public static readonly TYPE_NAME = "org.bluetooth.characteristic.cross_trainer_data";
    public static readonly NAME = "Cross Trainer Data";

    /** Parse from a DataView into {@link CrossTrainerData}. */
    public static fromDataView(dataView: DataView | DataViewReader, indexStart?: number | undefined): CrossTrainerDataImpl {
        return new CrossTrainerDataImpl(crossTrainerDataFromDataView(dataView, indexStart));
    }

    public readonly averagePower?: number | undefined;
    public readonly averageSpeed?: number | undefined;
    public readonly averageStepRate?: number | undefined;
    public readonly elapsedTime?: number | undefined;
    public readonly energyPerHour?: number | undefined;
    public readonly energyPerMinute?: number | undefined;
    public readonly flags: number;
    public readonly heartRate?: number | undefined;
    public readonly inclination?: number | undefined;
    public readonly instantaneousPower?: number | undefined;
    public readonly instantaneousSpeed?: number | undefined;
    public readonly metabolicEquivalent?: number | undefined;
    public readonly movementDirection: number;
    public readonly negativeElevationGain?: number | undefined;
    public readonly positiveElevationGain?: number | undefined;
    public readonly rampAngleSetting?: number | undefined;
    public readonly remainingTime?: number | undefined;
    public readonly resistanceLevel?: number | undefined;
    public readonly stepPerMinute?: number | undefined;
    public readonly strideCount?: number | undefined;
    public readonly totalDistance?: number | undefined;
    public readonly totalEnergy?: number | undefined;

    public constructor(crossTrainerData: CrossTrainerData) {
        this.averagePower = crossTrainerData.averagePower;
        this.averageSpeed = crossTrainerData.averageSpeed;
        this.averageStepRate = crossTrainerData.averageStepRate;
        this.elapsedTime = crossTrainerData.elapsedTime;
        this.energyPerHour = crossTrainerData.energyPerHour;
        this.energyPerMinute = crossTrainerData.energyPerMinute;
        this.flags = crossTrainerData.flags;
        this.heartRate = crossTrainerData.heartRate;
        this.inclination = crossTrainerData.inclination;
        this.instantaneousPower = crossTrainerData.instantaneousPower;
        this.instantaneousSpeed = crossTrainerData.instantaneousSpeed;
        this.metabolicEquivalent = crossTrainerData.metabolicEquivalent;
        this.movementDirection = crossTrainerData.movementDirection;
        this.negativeElevationGain = crossTrainerData.negativeElevationGain;
        this.positiveElevationGain = crossTrainerData.positiveElevationGain;
        this.rampAngleSetting = crossTrainerData.rampAngleSetting;
        this.remainingTime = crossTrainerData.remainingTime;
        this.resistanceLevel = crossTrainerData.resistanceLevel;
        this.stepPerMinute = crossTrainerData.stepPerMinute;
        this.strideCount = crossTrainerData.strideCount;
        this.totalDistance = crossTrainerData.totalDistance;
        this.totalEnergy = crossTrainerData.totalEnergy;
    }
}

/** Parse from a DataView into {@link CrossTrainerData}. */
export function crossTrainerDataFromDataView(dataView: DataView | DataViewReader, indexStart: number = 0): CrossTrainerData {
    const $dvr: DataViewReader = dataViewReader(dataView, indexStart);
    const flags = $dvr.uint24();
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     | C1  | False       |
     * | 1     |     | True        |
     * <p>Requirements: C1</p>
     */
    const moreData = !!(flags & 0b0000_0000_0000_0000_0000_0001);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C2  | True        |
     * <p>Requirements: C2</p>
     */
    const averageSpeedPresent = !!((flags & 0b0000_0000_0000_0000_0000_0010) >> 1);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C3  | True        |
     * <p>Requirements: C3</p>
     */
    const totalDistancePresent = !!((flags & 0b0000_0000_0000_0000_0000_0100) >> 2);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C4  | True        |
     * <p>Requirements: C4</p>
     */
    const stepCountPresent = !!((flags & 0b0000_0000_0000_0000_0000_1000) >> 3);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C5  | True        |
     * <p>Requirements: C5</p>
     */
    const strideCountPresent = !!((flags & 0b0000_0000_0000_0000_0001_0000) >> 4);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C6  | True        |
     * <p>Requirements: C6</p>
     */
    const elevationGainPresent = !!((flags & 0b0000_0000_0000_0000_0010_0000) >> 5);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C7  | True        |
     * <p>Requirements: C7</p>
     */
    const inclinationAndRampAngleSettingPresent = !!((flags & 0b0000_0000_0000_0000_0100_0000) >> 6);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C8  | True        |
     * <p>Requirements: C8</p>
     */
    const resistanceLevelPresent = !!((flags & 0b0000_0000_0000_0000_1000_0000) >> 7);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C9  | True        |
     * <p>Requirements: C9</p>
     */
    const instantaneousPowerPresent = !!((flags & 0b0000_0000_0000_0001_0000_0000) >> 8);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C10 | True        |
     * <p>Requirements: C10</p>
     */
    const averagePowerPresent = !!((flags & 0b0000_0000_0000_0010_0000_0000) >> 9);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C11 | True        |
     * <p>Requirements: C11</p>
     */
    const expendedEnergyPresent = !!((flags & 0b0000_0000_0000_0100_0000_0000) >> 10);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C12 | True        |
     * <p>Requirements: C12</p>
     */
    const heartRatePresent = !!((flags & 0b0000_0000_0000_1000_0000_0000) >> 11);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C13 | True        |
     * <p>Requirements: C13</p>
     */
    const metabolicEquivalentPresent = !!((flags & 0b0000_0000_0001_0000_0000_0000) >> 12);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C14 | True        |
     * <p>Requirements: C14</p>
     */
    const elapsedTimePresent = !!((flags & 0b0000_0000_0010_0000_0000_0000) >> 13);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C15 | True        |
     * <p>Requirements: C15</p>
     */
    const remainingTimePresent = !!((flags & 0b0000_0000_0100_0000_0000_0000) >> 14);
    /**
     * | value | description |
     * | ----- | ----------- |
     * | 0     | Forward     |
     * | 1     | Backward    |
     */
    const movementDirection = (flags & 0b0000_0000_1000_0000_0000_0000) >> 15;
    let instantaneousSpeed: number | undefined = undefined;
    if (!moreData) {
        instantaneousSpeed = $dvr.uint16();
    }

    let averageSpeed: number | undefined = undefined;
    if (averageSpeedPresent) {
        averageSpeed = $dvr.uint16();
    }

    let totalDistance: number | undefined = undefined;
    if (totalDistancePresent) {
        totalDistance = $dvr.uint24();
    }

    let stepPerMinute: number | undefined = undefined;
    if (stepCountPresent) {
        stepPerMinute = $dvr.uint16();
    }

    let averageStepRate: number | undefined = undefined;
    if (stepCountPresent) {
        averageStepRate = $dvr.uint16();
    }

    let strideCount: number | undefined = undefined;
    if (strideCountPresent) {
        strideCount = $dvr.uint16();
    }

    let positiveElevationGain: number | undefined = undefined;
    if (elevationGainPresent) {
        positiveElevationGain = $dvr.uint16();
    }

    let negativeElevationGain: number | undefined = undefined;
    if (elevationGainPresent) {
        negativeElevationGain = $dvr.uint16();
    }

    let inclination: number | undefined = undefined;
    if (inclinationAndRampAngleSettingPresent) {
        inclination = $dvr.int16();
    }

    let rampAngleSetting: number | undefined = undefined;
    if (inclinationAndRampAngleSettingPresent) {
        rampAngleSetting = $dvr.int16();
    }

    let resistanceLevel: number | undefined = undefined;
    if (resistanceLevelPresent) {
        resistanceLevel = $dvr.int16();
    }

    let instantaneousPower: number | undefined = undefined;
    if (instantaneousPowerPresent) {
        instantaneousPower = $dvr.int16();
    }

    let averagePower: number | undefined = undefined;
    if (averagePowerPresent) {
        averagePower = $dvr.int16();
    }

    let totalEnergy: number | undefined = undefined;
    if (expendedEnergyPresent) {
        totalEnergy = $dvr.uint16();
    }

    let energyPerHour: number | undefined = undefined;
    if (expendedEnergyPresent) {
        energyPerHour = $dvr.uint16();
    }

    let energyPerMinute: number | undefined = undefined;
    if (expendedEnergyPresent) {
        energyPerMinute = $dvr.uint8();
    }

    let heartRate: number | undefined = undefined;
    if (heartRatePresent) {
        heartRate = $dvr.uint8();
    }

    let metabolicEquivalent: number | undefined = undefined;
    if (metabolicEquivalentPresent) {
        metabolicEquivalent = $dvr.uint8();
    }

    let elapsedTime: number | undefined = undefined;
    if (elapsedTimePresent) {
        elapsedTime = $dvr.uint16();
    }

    let remainingTime: number | undefined = undefined;
    if (remainingTimePresent) {
        remainingTime = $dvr.uint16();
    }

    return { averagePower, averageSpeed, averageStepRate, elapsedTime, energyPerHour, energyPerMinute, flags, heartRate, inclination, instantaneousPower, instantaneousSpeed, metabolicEquivalent, movementDirection, negativeElevationGain, positiveElevationGain, rampAngleSetting, remainingTime, resistanceLevel, stepPerMinute, strideCount, totalDistance, totalEnergy };
}
