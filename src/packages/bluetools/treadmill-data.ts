import { type DataViewReader, dataViewReader } from "./data-view-reader.js";

// This file is autogenerated.
// Do not edit it by hand, as changes will be lost.
// Upstream source: https://raw.githubusercontent.com/oesmith/gatt-xml/refs/heads/master/org.bluetooth.characteristic.treadmill_data.xml
/** <p>The Treadmill Data characteristic is used to send training-related data to the Client from a treadmill (Server).</p> */
export interface TreadmillData {
    /**
     * <p>Format: `uint8`</p>
     * <p>Unit: `org.bluetooth.unit.velocity.kilometre_per_minute`</p>
     * <p>Kilometer per minute with a resolution of 0.1</p>
     */
    averagePace?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.velocity.kilometre_per_hour`</p>
     * <p>Kilometer per hour with a resolution of 0.01</p>
     */
    averageSpeed?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.time.second`</p>
     * <p>Second with a resolution of 1</p>
     */
    elapsedTime?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.energy.kilogram_calorie`</p>
     * <p>Kilo Calorie with a resolution of 1</p>
     */
    energyPerHour?: number | undefined;
    /**
     * <p>Format: `uint8`</p>
     * <p>Unit: `org.bluetooth.unit.energy.kilogram_calorie`</p>
     * <p>Kilo Calorie with a resolution of 1</p>
     */
    energyPerMinute?: number | undefined;
    /**
     * <p>Format: `16bit`</p>
     *
     * Bit field:
     *
     * | index | size | req | name                                       |
     * | ----- | ---- | --- | ------------------------------------------ |
     * | 0     | 1    | C1  | More Data                                  |
     * | 1     | 1    | C2  | Average Speed present                      |
     * | 2     | 1    | C3  | Total Distance Present                     |
     * | 3     | 1    | C4  | Inclination and Ramp Angle Setting present |
     * | 4     | 1    | C5  | Elevation Gain present                     |
     * | 5     | 1    | C6  | Instantaneous Pace present                 |
     * | 6     | 1    | C7  | Average Pace present                       |
     * | 7     | 1    | C8  | Expended Energy present                    |
     * | 8     | 1    | C9  | Heart Rate present                         |
     * | 9     | 1    | C10 | Metabolic Equivalent present               |
     * | 10    | 1    | C11 | Elapsed Time present                       |
     * | 11    | 1    | C12 | Remaining Time present                     |
     * | 12    | 1    | C13 | Force on Belt and Power Output present     |
     * | 13    | 3    |     | Reserved for future use                    |
     *
     */
    flags: number;
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.force.newton`</p>
     * <p>Newton with a resolution of 1</p>
     */
    forceOnBelt?: number | undefined;
    /**
     * <p>Format: `uint8`</p>
     * <p>Unit: `org.bluetooth.unit.period.beats_per_minute`</p>
     * <p>Beats per minute with a resolution of 1</p>
     */
    heartRate?: number | undefined;
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.percentage`</p>
     * <p>Percent with a resolution of 0.1</p>
     */
    inclination?: number | undefined;
    /**
     * <p>Format: `uint8`</p>
     * <p>Unit: `org.bluetooth.unit.velocity.kilometre_per_minute`</p>
     * <p>Kilometer per minute with a resolution of 0.1</p>
     */
    instantaneousPace?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.velocity.kilometre_per_hour`</p>
     * <p>Kilometer per hour with a resolution of 0.01</p>
     */
    instantaneousSpeed?: number | undefined;
    /**
     * <p>Format: `uint8`</p>
     * <p>Unit: `org.bluetooth.unit.metabolic_equivalent`</p>
     * <p>Metabolic Equivalent with a resolution of 0.1</p>
     */
    metabolicEquivalent?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.length.metre`</p>
     * <p>Meters with a resolution of 0.1</p>
     */
    negativeElevationGain?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.length.metre`</p>
     * <p>Meters with a resolution of 0.1</p>
     */
    positiveElevationGain?: number | undefined;
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.power.watt`</p>
     * <p>Watts with a resolution of 1</p>
     */
    powerOutput?: number | undefined;
    /**
     * <p>Format: `sint16`</p>
     * <p>Unit: `org.bluetooth.unit.plane_angle.degree`</p>
     * <p>Degree with a resolution of 0.1</p>
     */
    rampAngleSetting?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.time.second`</p>
     * <p>Second with a resolution of 1</p>
     */
    remainingTime?: number | undefined;
    /**
     * <p>Format: `uint24`</p>
     * <p>Unit: `org.bluetooth.unit.length.metre`</p>
     * <p>Meters with a resolution of 1</p>
     */
    totalDistance?: number | undefined;
    /**
     * <p>Format: `uint16`</p>
     * <p>Unit: `org.bluetooth.unit.energy.kilogram_calorie`</p>
     * <p>Kilo Calorie with a resolution of 1</p>
     */
    totalEnergy?: number | undefined;
}

/** @see {@link https://raw.githubusercontent.com/oesmith/gatt-xml/refs/heads/master/org.bluetooth.characteristic.treadmill_data.xml | Treadmill Data} */
export class TreadmillDataImpl implements TreadmillData {
    public static readonly UUID_PREFIX = 0x2acd;
    public static readonly TYPE_NAME = "org.bluetooth.characteristic.treadmill_data";
    public static readonly NAME = "Treadmill Data";

    /** Parse from a DataView into {@link TreadmillData}. */
    public static fromDataView(dataView: DataView | DataViewReader, indexStart?: number | undefined): TreadmillDataImpl {
        return new TreadmillDataImpl(treadmillDataFromDataView(dataView, indexStart));
    }

    public readonly averagePace?: number | undefined;
    public readonly averageSpeed?: number | undefined;
    public readonly elapsedTime?: number | undefined;
    public readonly energyPerHour?: number | undefined;
    public readonly energyPerMinute?: number | undefined;
    public readonly flags: number;
    public readonly forceOnBelt?: number | undefined;
    public readonly heartRate?: number | undefined;
    public readonly inclination?: number | undefined;
    public readonly instantaneousPace?: number | undefined;
    public readonly instantaneousSpeed?: number | undefined;
    public readonly metabolicEquivalent?: number | undefined;
    public readonly negativeElevationGain?: number | undefined;
    public readonly positiveElevationGain?: number | undefined;
    public readonly powerOutput?: number | undefined;
    public readonly rampAngleSetting?: number | undefined;
    public readonly remainingTime?: number | undefined;
    public readonly totalDistance?: number | undefined;
    public readonly totalEnergy?: number | undefined;

    public constructor(treadmillData: TreadmillData) {
        this.averagePace = treadmillData.averagePace;
        this.averageSpeed = treadmillData.averageSpeed;
        this.elapsedTime = treadmillData.elapsedTime;
        this.energyPerHour = treadmillData.energyPerHour;
        this.energyPerMinute = treadmillData.energyPerMinute;
        this.flags = treadmillData.flags;
        this.forceOnBelt = treadmillData.forceOnBelt;
        this.heartRate = treadmillData.heartRate;
        this.inclination = treadmillData.inclination;
        this.instantaneousPace = treadmillData.instantaneousPace;
        this.instantaneousSpeed = treadmillData.instantaneousSpeed;
        this.metabolicEquivalent = treadmillData.metabolicEquivalent;
        this.negativeElevationGain = treadmillData.negativeElevationGain;
        this.positiveElevationGain = treadmillData.positiveElevationGain;
        this.powerOutput = treadmillData.powerOutput;
        this.rampAngleSetting = treadmillData.rampAngleSetting;
        this.remainingTime = treadmillData.remainingTime;
        this.totalDistance = treadmillData.totalDistance;
        this.totalEnergy = treadmillData.totalEnergy;
    }
}

/** Parse from a DataView into {@link TreadmillData}. */
export function treadmillDataFromDataView(dataView: DataView | DataViewReader, indexStart: number = 0): TreadmillData {
    const $dvr: DataViewReader = dataViewReader(dataView, indexStart);
    const flags = $dvr.uint16();
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     | C1  | False       |
     * | 1     |     | True        |
     * <p>Requirements: C1</p>
     */
    const moreData = !!(flags & 0b0000_0000_0000_0001);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C2  | True        |
     * <p>Requirements: C2</p>
     */
    const averageSpeedPresent = !!((flags & 0b0000_0000_0000_0010) >> 1);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C3  | True        |
     * <p>Requirements: C3</p>
     */
    const totalDistancePresent = !!((flags & 0b0000_0000_0000_0100) >> 2);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C4  | True        |
     * <p>Requirements: C4</p>
     */
    const inclinationAndRampAngleSettingPresent = !!((flags & 0b0000_0000_0000_1000) >> 3);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C5  | True        |
     * <p>Requirements: C5</p>
     */
    const elevationGainPresent = !!((flags & 0b0000_0000_0001_0000) >> 4);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C6  | True        |
     * <p>Requirements: C6</p>
     */
    const instantaneousPacePresent = !!((flags & 0b0000_0000_0010_0000) >> 5);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C7  | True        |
     * <p>Requirements: C7</p>
     */
    const averagePacePresent = !!((flags & 0b0000_0000_0100_0000) >> 6);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C8  | True        |
     * <p>Requirements: C8</p>
     */
    const expendedEnergyPresent = !!((flags & 0b0000_0000_1000_0000) >> 7);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C9  | True        |
     * <p>Requirements: C9</p>
     */
    const heartRatePresent = !!((flags & 0b0000_0001_0000_0000) >> 8);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C10 | True        |
     * <p>Requirements: C10</p>
     */
    const metabolicEquivalentPresent = !!((flags & 0b0000_0010_0000_0000) >> 9);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C11 | True        |
     * <p>Requirements: C11</p>
     */
    const elapsedTimePresent = !!((flags & 0b0000_0100_0000_0000) >> 10);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C12 | True        |
     * <p>Requirements: C12</p>
     */
    const remainingTimePresent = !!((flags & 0b0000_1000_0000_0000) >> 11);
    /**
     * | value | req | description |
     * | ----- | --- | ----------- |
     * | 0     |     | False       |
     * | 1     | C13 | True        |
     * <p>Requirements: C13</p>
     */
    const forceOnBeltAndPowerOutputPresent = !!((flags & 0b0001_0000_0000_0000) >> 12);
    let instantaneousSpeed: number | undefined = undefined;
    if (!moreData) {
        instantaneousSpeed = $dvr.uint16();
    }

    let averageSpeed: number | undefined = undefined;
    if (averageSpeedPresent) {
        averageSpeed = $dvr.uint16();
    }

    let totalDistance: number | undefined = undefined;
    if (totalDistancePresent) {
        totalDistance = $dvr.uint24();
    }

    let inclination: number | undefined = undefined;
    if (inclinationAndRampAngleSettingPresent) {
        inclination = $dvr.int16();
    }

    let rampAngleSetting: number | undefined = undefined;
    if (inclinationAndRampAngleSettingPresent) {
        rampAngleSetting = $dvr.int16();
    }

    let positiveElevationGain: number | undefined = undefined;
    if (elevationGainPresent) {
        positiveElevationGain = $dvr.uint16();
    }

    let negativeElevationGain: number | undefined = undefined;
    if (elevationGainPresent) {
        negativeElevationGain = $dvr.uint16();
    }

    let instantaneousPace: number | undefined = undefined;
    if (instantaneousPacePresent) {
        instantaneousPace = $dvr.uint8();
    }

    let averagePace: number | undefined = undefined;
    if (averagePacePresent) {
        averagePace = $dvr.uint8();
    }

    let totalEnergy: number | undefined = undefined;
    if (expendedEnergyPresent) {
        totalEnergy = $dvr.uint16();
    }

    let energyPerHour: number | undefined = undefined;
    if (expendedEnergyPresent) {
        energyPerHour = $dvr.uint16();
    }

    let energyPerMinute: number | undefined = undefined;
    if (expendedEnergyPresent) {
        energyPerMinute = $dvr.uint8();
    }

    let heartRate: number | undefined = undefined;
    if (heartRatePresent) {
        heartRate = $dvr.uint8();
    }

    let metabolicEquivalent: number | undefined = undefined;
    if (metabolicEquivalentPresent) {
        metabolicEquivalent = $dvr.uint8();
    }

    let elapsedTime: number | undefined = undefined;
    if (elapsedTimePresent) {
        elapsedTime = $dvr.uint16();
    }

    let remainingTime: number | undefined = undefined;
    if (remainingTimePresent) {
        remainingTime = $dvr.uint16();
    }

    let forceOnBelt: number | undefined = undefined;
    if (forceOnBeltAndPowerOutputPresent) {
        forceOnBelt = $dvr.int16();
    }

    let powerOutput: number | undefined = undefined;
    if (forceOnBeltAndPowerOutputPresent) {
        powerOutput = $dvr.int16();
    }

    return { averagePace, averageSpeed, elapsedTime, energyPerHour, energyPerMinute, flags, forceOnBelt, heartRate, inclination, instantaneousPace, instantaneousSpeed, metabolicEquivalent, negativeElevationGain, positiveElevationGain, powerOutput, rampAngleSetting, remainingTime, totalDistance, totalEnergy };
}
