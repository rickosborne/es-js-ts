import { type DataViewReader, dataViewReader } from "./data-view-reader.js";

// This file is autogenerated.
// Do not edit it by hand, as changes will be lost.
// Upstream source: https://raw.githubusercontent.com/oesmith/gatt-xml/refs/heads/master/org.bluetooth.characteristic.blood_pressure_feature.xml
/** <p>The Blood Pressure Feature characteristic is used to describe the supported features of the Blood Pressure Sensor.</p> */
export interface BloodPressureFeature {
    /**
     * <p>Format: `16bit`</p>
     *
     * Bit field:
     *
     * | index | size | name                                       |
     * | ----- | ---- | ------------------------------------------ |
     * | 0     | 1    | Body Movement Detection Support bit        |
     * | 1     | 1    | Cuff Fit Detection Support bit             |
     * | 2     | 1    | Irregular Pulse Detection Support bit      |
     * | 3     | 1    | Pulse Rate Range Detection Support bit     |
     * | 4     | 1    | Measurement Position Detection Support bit |
     * | 5     | 1    | Multiple Bond Support bit                  |
     * | 6     | 10   | Reserved for future use                    |
     *
     */
    bloodPressureFeature: number;
    /**
     * | value | description                                   |
     * | ----- | --------------------------------------------- |
     * | 0     | Body Movement Detection feature not supported |
     * | 1     | Body Movement Detection feature supported     |
     */
    bodyMovementDetectionSupportBit: number;
    /**
     * | value | description                              |
     * | ----- | ---------------------------------------- |
     * | 0     | Cuff Fit Detection feature not supported |
     * | 1     | Cuff Fit Detection feature supported     |
     */
    cuffFitDetectionSupportBit: number;
    /**
     * | value | description                                     |
     * | ----- | ----------------------------------------------- |
     * | 0     | Irregular Pulse Detection feature not supported |
     * | 1     | Irregular Pulse Detection feature supported     |
     */
    irregularPulseDetectionSupportBit: number;
    /**
     * | value | description                                          |
     * | ----- | ---------------------------------------------------- |
     * | 0     | Measurement Position Detection feature not supported |
     * | 1     | Measurement Position Detection feature supported     |
     */
    measurementPositionDetectionSupportBit: number;
    /**
     * | value | description                  |
     * | ----- | ---------------------------- |
     * | 0     | Multiple Bonds not supported |
     * | 1     | Multiple Bonds supported     |
     */
    multipleBondSupportBit: number;
    /**
     * | value | description                                      |
     * | ----- | ------------------------------------------------ |
     * | 0     | Pulse Rate Range Detection feature not supported |
     * | 1     | Pulse Rate Range Detection feature supported     |
     */
    pulseRateRangeDetectionSupportBit: number;
}

/** @see {@link https://raw.githubusercontent.com/oesmith/gatt-xml/refs/heads/master/org.bluetooth.characteristic.blood_pressure_feature.xml | Blood Pressure Feature} */
export class BloodPressureFeatureImpl implements BloodPressureFeature {
    public static readonly UUID_PREFIX = 0x2a49;
    public static readonly TYPE_NAME = "org.bluetooth.characteristic.blood_pressure_feature";
    public static readonly NAME = "Blood Pressure Feature";

    /** Parse from a DataView into {@link BloodPressureFeature}. */
    public static fromDataView(dataView: DataView | DataViewReader, indexStart?: number | undefined): BloodPressureFeatureImpl {
        return new BloodPressureFeatureImpl(bloodPressureFeatureFromDataView(dataView, indexStart));
    }

    public readonly bloodPressureFeature: number;
    public readonly bodyMovementDetectionSupportBit: number;
    public readonly cuffFitDetectionSupportBit: number;
    public readonly irregularPulseDetectionSupportBit: number;
    public readonly measurementPositionDetectionSupportBit: number;
    public readonly multipleBondSupportBit: number;
    public readonly pulseRateRangeDetectionSupportBit: number;

    public constructor(bloodPressureFeature: BloodPressureFeature) {
        this.bloodPressureFeature = bloodPressureFeature.bloodPressureFeature;
        this.bodyMovementDetectionSupportBit = bloodPressureFeature.bodyMovementDetectionSupportBit;
        this.cuffFitDetectionSupportBit = bloodPressureFeature.cuffFitDetectionSupportBit;
        this.irregularPulseDetectionSupportBit = bloodPressureFeature.irregularPulseDetectionSupportBit;
        this.measurementPositionDetectionSupportBit = bloodPressureFeature.measurementPositionDetectionSupportBit;
        this.multipleBondSupportBit = bloodPressureFeature.multipleBondSupportBit;
        this.pulseRateRangeDetectionSupportBit = bloodPressureFeature.pulseRateRangeDetectionSupportBit;
    }
}

/** Parse from a DataView into {@link BloodPressureFeature}. */
export function bloodPressureFeatureFromDataView(dataView: DataView | DataViewReader, indexStart: number = 0): BloodPressureFeature {
    const $dvr: DataViewReader = dataViewReader(dataView, indexStart);
    const bloodPressureFeature = $dvr.uint16();
    /**
     * | value | description                                   |
     * | ----- | --------------------------------------------- |
     * | 0     | Body Movement Detection feature not supported |
     * | 1     | Body Movement Detection feature supported     |
     */
    const bodyMovementDetectionSupportBit = bloodPressureFeature & 0b0000_0000_0000_0001;
    /**
     * | value | description                              |
     * | ----- | ---------------------------------------- |
     * | 0     | Cuff Fit Detection feature not supported |
     * | 1     | Cuff Fit Detection feature supported     |
     */
    const cuffFitDetectionSupportBit = (bloodPressureFeature & 0b0000_0000_0000_0010) >> 1;
    /**
     * | value | description                                     |
     * | ----- | ----------------------------------------------- |
     * | 0     | Irregular Pulse Detection feature not supported |
     * | 1     | Irregular Pulse Detection feature supported     |
     */
    const irregularPulseDetectionSupportBit = (bloodPressureFeature & 0b0000_0000_0000_0100) >> 2;
    /**
     * | value | description                                      |
     * | ----- | ------------------------------------------------ |
     * | 0     | Pulse Rate Range Detection feature not supported |
     * | 1     | Pulse Rate Range Detection feature supported     |
     */
    const pulseRateRangeDetectionSupportBit = (bloodPressureFeature & 0b0000_0000_0000_1000) >> 3;
    /**
     * | value | description                                          |
     * | ----- | ---------------------------------------------------- |
     * | 0     | Measurement Position Detection feature not supported |
     * | 1     | Measurement Position Detection feature supported     |
     */
    const measurementPositionDetectionSupportBit = (bloodPressureFeature & 0b0000_0000_0001_0000) >> 4;
    /**
     * | value | description                  |
     * | ----- | ---------------------------- |
     * | 0     | Multiple Bonds not supported |
     * | 1     | Multiple Bonds supported     |
     */
    const multipleBondSupportBit = (bloodPressureFeature & 0b0000_0000_0010_0000) >> 5;
    return { bloodPressureFeature, bodyMovementDetectionSupportBit, cuffFitDetectionSupportBit, irregularPulseDetectionSupportBit, measurementPositionDetectionSupportBit, multipleBondSupportBit, pulseRateRangeDetectionSupportBit };
}
